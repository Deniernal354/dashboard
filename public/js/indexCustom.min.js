function setAttributes(t,e){for(var a in e)t.setAttribute(a,e[a])}!function(t,e){jQuery.fn[e]=function(t){return t?this.bind("resize",(a=t,function(){var t=this,e=arguments;o?clearTimeout(o):i&&a.apply(t,e),o=setTimeout(function(){i||a.apply(t,e),o=null},n||100)})):this.trigger(e);var a,n,i,o}}(jQuery,"smartresize"),"undefined"!=typeof NProgress&&NProgress.start();var CURRENT_URL=window.location.href.split("#")[0].split("?")[0],$BODY=$("body"),$MENU_TOGGLE=$("#menu_toggle"),$SIDEBAR_MENU=$("#sidebar-menu"),$SIDEBAR_FOOTER=$(".sidebar-footer"),$LEFT_COL=$(".left_col"),$RIGHT_COL=$(".right_col"),$NAV_MENU=$(".nav_menu"),$FOOTER=$("footer");function init_sidebar(){var a=function(){$RIGHT_COL.css("min-height",$(window).height());var t=$BODY.outerHeight(),e=$BODY.hasClass("footer_fixed")?-10:$FOOTER.height(),a=$LEFT_COL.eq(1).height()+$SIDEBAR_FOOTER.height(),n=t<a?a:t;n-=$NAV_MENU.height()+e,$RIGHT_COL.css("min-height",n)};$SIDEBAR_MENU.find("a").on("click",function(t){var e=$(this).parent();e.is(".active")?(e.removeClass("active active-sm"),$("ul:first",e).slideUp(function(){a()})):(e.parent().is(".child_menu")?$BODY.is(".nav-sm")&&($SIDEBAR_MENU.find("li").removeClass("active active-sm"),$SIDEBAR_MENU.find("li ul").slideUp()):($SIDEBAR_MENU.find("li").removeClass("active active-sm"),$SIDEBAR_MENU.find("li ul").slideUp()),e.addClass("active"),$("ul:first",e).slideDown(function(){a()}))}),$MENU_TOGGLE.on("click",function(){$BODY.hasClass("nav-md")?($SIDEBAR_MENU.find("li.active ul").hide(),$SIDEBAR_MENU.find("li.active").addClass("active-sm").removeClass("active")):($SIDEBAR_MENU.find("li.active-sm ul").show(),$SIDEBAR_MENU.find("li.active-sm").addClass("active").removeClass("active-sm")),$BODY.toggleClass("nav-md nav-sm"),a(),$(".dataTable").each(function(){$(this).dataTable().fnDraw()})}),$SIDEBAR_MENU.find("a[href='"+CURRENT_URL+"']").parent("li").addClass("current-page"),$SIDEBAR_MENU.find("a").filter(function(){return this.href==CURRENT_URL}).parent("li").addClass("current-page").parents("ul").slideDown(function(){a()}).parent().addClass("active"),$(window).smartresize(function(){a()}),a(),$.fn.mCustomScrollbar&&$(".menu_fixed").mCustomScrollbar({autoHideScrollbar:!0,theme:"minimal",mouseWheel:{preventDefault:!0}})}function init_panel(){$(".collapse-link").on("click",function(){var t=$(this).closest(".x_panel"),e=$(this).find("i"),a=t.find(".x_content");t.attr("style")?a.slideToggle(200,function(){t.removeAttr("style")}):(a.slideToggle(200),t.css("height","auto")),e.toggleClass("fa-chevron-up fa-chevron-down")}),$(".close-link").click(function(){$(this).closest(".x_panel").remove()})}function init_tooltip(){$("[data-toggle='tooltip']").tooltip({container:"body"})}function commonXMLHttpRequest(){var t=new XMLHttpRequest;return t.onreadystatechange=function(){500===t.status&&(window.location="/auto/500")},t}function updateProjectDetail(p,h,g){return function(){for(var t=document.createDocumentFragment(),e=document.getElementById("failProject");e.hasChildNodes();)e.removeChild(e.firstChild);document.getElementById("failProjectTitle").innerText="Project 상세 - "+p[g];for(var a=0;a<h[0][g];a++){var n=h[1][g][a],i=document.createElement("li"),o=document.createElement("a"),r=document.createElement("i");i.setAttribute("class","media event"),o.setAttribute("class","pull-left border-pass profile_thumb"),r.setAttribute("class","fa fa-archive pass"),o.appendChild(r),i.appendChild(o);var l=document.createElement("div");l.setAttribute("class","media-body");var s=document.createElement("a");setAttributes(s,{id:"failTitle"+a,class:"title"}),s.innerText=n.pj_name;var d=document.createElement("p"),m=n.pass+n.skip+n.fail,c=Math.round(n.fail/m*100).toFixed(1);d.setAttribute("id","failp"+a),d.innerText=m+"개 TC중 "+n.fail+"개 TC Fail ("+c+"%)";var u=document.createElement("p"),f=document.createElement("small");f.setAttribute("id","failauthor"+a),f.innerText=n.pj_author,u.appendChild(f),l.appendChild(s),l.appendChild(d),l.appendChild(u),i.appendChild(l),t.appendChild(i)}document.getElementById("failProject").appendChild(t)}}function init_failChart(t,e,a){if(document.getElementById("failChart")&&"undefined"!=typeof Chart){for(var n=[],i=[[],[]],o=e;-1<o;o--)i[0][o]=0,i[1][o]=[],n.push(moment(a,"YYYY/MM/DD").subtract(o,"day").format("MM/DD"));t.data.forEach(function(t){var e=n.indexOf(t.start_t.slice(5,10));10<1*t.failrate&&(i[0][e]++,i[1][e].push(t))});var r=new Chart(document.getElementById("failChart"),{type:"bar",data:{labels:n,datasets:[{label:"Project수",backgroundColor:"rgba(102, 194, 255, 0.7)",data:i[0]}]},options:{scales:{yAxes:[{ticks:{beginAtZero:!0}}]},legend:!1}});updateProjectDetail(n,i,e)(),document.getElementById("failChart").addEventListener("click",function(t){var e=r.getElementsAtEventForMode(t,"index",{intersect:!1});0!=e.length&&updateProjectDetail(n,i,e[0]._index)()})}}function change_failChart(t,e){document.getElementById("failChartDiv").removeChild(document.getElementById("failChart"));var a=document.createElement("canvas");a.setAttribute("id","failChart"),document.getElementById("failChartDiv").appendChild(a);for(var n=document.getElementById("failProject");n.hasChildNodes();)n.removeChild(n.firstChild);var i=commonXMLHttpRequest();i.open("GET","/getData/getFailChartData?start="+t+"&end="+e,!0),i.send(),i.addEventListener("load",function(){var t=JSON.parse(i.responseText);init_failChart(t,t.diff,t.end)})}function init_platformChart(t){if(document.getElementById("platformChartDiv")&&"undefined"!=typeof Chart){for(var e=0;e<5;e++)document.getElementById("plat_info"+e).innerHTML+="("+t.platResult[2][e]+"%)";new Chart(document.getElementById("platformChartDiv"),{type:"doughnut",data:{labels:["PC Web","PC App","Mobile Web","Mobile App","API"],datasets:[{data:t.platResult[1],backgroundColor:["rgba(102, 194, 255, 0.7)","rgba(155, 89, 182, 0.7)","rgba(255, 115, 115, 0.7)","rgba(255, 236, 80, 0.7)","rgba(180, 238, 180, 0.7)"],hoverBackgroundColor:["rgba(102, 194, 255, 1.0)","rgba(155, 89, 182, 1.0)","rgba(255, 115, 115, 1.0)","rgba(255, 236, 80, 1.0)","rgba(180, 238, 180, 1.0)"],label:["PC Web","PC App","Mobile Web","Mobile App","API"]}]},options:{legend:!1,responsive:!0,maintainAspectRatio:!1}})}}function init_indexData(){console.log("init_indexData");var n=commonXMLHttpRequest();n.open("GET","/getData/getIndexData",!0),n.send(),n.addEventListener("load",function(){var t=JSON.parse(n.responseText),e=t.data.reduce(function(t,e,a,n){return t+1*e.passrate},0);document.getElementById("allCnt").innerText=t.allCnt,document.getElementById("todayCnt").innerText=t.todayCnt,0===t.data.length?document.getElementById("passCnt").innerText="0.0%":document.getElementById("passCnt").innerText=Math.round(e/t.data.length).toFixed(1)+"%",$("#todayProject").html(moment().format("YYYY.MM.DD")+" 기준");for(var a=0;a<t.teamResult[0].length;a++)document.getElementById("teamleft"+a).innerText=t.teamResult[0][a],document.getElementById("teamright"+a).innerText=t.teamResult[1][a]+" 개",setAttributes(document.getElementById("teamcenter"+a),{"aria-valuenow":t.teamResult[1][a],"aria-valuemax":t.allCnt,style:"width: "+t.teamResult[2][a]+"%"});init_platformChart(t),init_failChart(t,6,moment().format("YYYY/MM/DD"))})}function init_compose(){void 0!==$.fn.slideToggle&&(console.log("init_compose"),$("#compose, .compose-close").click(function(){$(".compose").slideToggle()}))}function init_daterangepicker(){if(void 0!==$.fn.daterangepicker){console.log("init_daterangepicker");var t={startDate:moment().subtract(29,"days"),endDate:moment(),minDate:"01/01/2017",maxDate:moment().add(1,"years"),showDropdowns:!0,timePicker:!1,timePickerIncrement:1,ranges:{Today:[moment(),moment()],Yesterday:[moment().subtract(1,"days"),moment().subtract(1,"days")],"Last 7 Days":[moment().subtract(6,"days"),moment()],"Last 30 Days":[moment().subtract(29,"days"),moment()],"This Month":[moment().startOf("month"),moment().endOf("month")],"Last Month":[moment().subtract(1,"month").startOf("month"),moment().subtract(1,"month").endOf("month")]},opens:"left",buttonClasses:["btn btn-default"],applyClass:"btn-small btn-primary",cancelClass:"btn-small",format:"MM/DD/YYYY",separator:" to ",locale:{applyLabel:"Submit",cancelLabel:"Clear",fromLabel:"From",toLabel:"To",customRangeLabel:"Custom",daysOfWeek:["Su","Mo","Tu","We","Th","Fr","Sa"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],firstDay:1}};$("#reportrange span").html(moment().subtract(6,"days").format("MMMM D, YYYY")+" - "+moment().format("MMMM D, YYYY")),$("#reportrange").daterangepicker(t,function(t,e,a){$("#reportrange span").html(t.format("MMMM D, YYYY")+" - "+e.format("MMMM D, YYYY"))}),$("#reportrange").on("apply.daterangepicker",function(t,e){change_failChart(e.startDate.format("YYYY/MM/DD HH:mm:ss"),e.endDate.format("YYYY/MM/DD HH:mm:ss"))})}}function init_PNotify(){"undefined"!=typeof PNotify&&(console.log("init_PNotify"),PNotify.info({title:"v2.1.1\n\n개편된 팀 정보가 적용되었습니다.",text:"팀 소속이 변경된 분들은 공지사항을 참고해주세요!",styling:"bootstrap3",icons:"fontawesome4",delay:5e3,modules:{Buttons:{sticker:!1}},addClass:"dark"}))}$(document).ready(function(){init_sidebar(),init_panel(),init_tooltip()}),$(document).ready(function(){init_compose(),init_indexData(),init_daterangepicker(),init_PNotify()}),$(window).on("load",function(){NProgress.done()});