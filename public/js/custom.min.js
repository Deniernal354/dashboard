function setAttributes(e,t){for(var n in t)e.setAttribute(n,t[n])}function init_sidebar(){var e=function(){$RIGHT_COL.css("min-height",$(window).height());var e=$BODY.outerHeight(),t=$BODY.hasClass("footer_fixed")?-10:$FOOTER.height(),n=$LEFT_COL.eq(1).height()+$SIDEBAR_FOOTER.height(),a=e<n?n:e;a-=$NAV_MENU.height()+t,$RIGHT_COL.css("min-height",a)};$SIDEBAR_MENU.find("a").on("click",function(t){var n=$(this).parent();n.is(".active")?(n.removeClass("active active-sm"),$("ul:first",n).slideUp(function(){e()})):(n.parent().is(".child_menu")?$BODY.is(".nav-sm")&&($SIDEBAR_MENU.find("li").removeClass("active active-sm"),$SIDEBAR_MENU.find("li ul").slideUp()):($SIDEBAR_MENU.find("li").removeClass("active active-sm"),$SIDEBAR_MENU.find("li ul").slideUp()),n.addClass("active"),$("ul:first",n).slideDown(function(){e()}))}),$MENU_TOGGLE.on("click",function(){$BODY.hasClass("nav-md")?($SIDEBAR_MENU.find("li.active ul").hide(),$SIDEBAR_MENU.find("li.active").addClass("active-sm").removeClass("active")):($SIDEBAR_MENU.find("li.active-sm ul").show(),$SIDEBAR_MENU.find("li.active-sm").addClass("active").removeClass("active-sm")),$BODY.toggleClass("nav-md nav-sm"),e(),$(".dataTable").each(function(){$(this).dataTable().fnDraw()})}),$SIDEBAR_MENU.find("a[href='"+CURRENT_URL+"']").parent("li").addClass("current-page"),$SIDEBAR_MENU.find("a").filter(function(){return this.href==CURRENT_URL}).parent("li").addClass("current-page").parents("ul").slideDown(function(){e()}).parent().addClass("active"),$(window).smartresize(function(){e()}),e(),$.fn.mCustomScrollbar&&$(".menu_fixed").mCustomScrollbar({autoHideScrollbar:!0,theme:"minimal",mouseWheel:{preventDefault:!0}})}function init_panel(){$(".collapse-link").on("click",function(){var e=$(this).closest(".x_panel"),t=$(this).find("i"),n=e.find(".x_content");e.attr("style")?n.slideToggle(200,function(){e.removeAttr("style")}):(n.slideToggle(200),e.css("height","auto")),t.toggleClass("fa-chevron-up fa-chevron-down")}),$(".close-link").click(function(){$(this).closest(".x_panel").remove()})}function init_tooltip(){$("[data-toggle='tooltip']").tooltip({container:"body"})}function urlByBrowser(){var e=navigator.userAgent.toLowerCase();return e.indexOf("msie")>-1||e.indexOf(!1)?document.URL:document.documentURI}function selectDataApi(e,t){var n="/getData",a=urlByBrowser();return a=a.substring(a.indexOf(":")+3),"chart"===e?n+="/getChartData"+a.substring(a.indexOf("/")):"knob"===e?n="/admin/getKnobData/":"custom"===e?n+="/getCustomData/"+t.unit+"/"+t.preValId:"initialModal"===e?n+="/getInitialModalData/"+t.pj_id:"modalDetail"===e&&(n+="/getModalDataDetail/"+t.pj_id+"/"+t.build_id),n}function processdata(e){var t=[],n=[],a=[],i=[],o=[],r=[],l=[],s=[],d=[],c=e.totalChartCount;if(o=e.pj_label.slice(),c){var u=e.pj_label[0].pj_platform;u="pcWeb"===u?"PC Web":"mobileWeb"===u?"Mobile Web":"mobileApp"===u?"Mobile App":"Error",d.push(u),d.push(e.pj_label[0].pj_team),d.push(e.pj_label[0].pj_author)}for(var p=0;p<c;p++){t[p]=[],n[p]=[],n[p][0]=[],n[p][1]=[],n[p][2]=[],i[p]=e.pj_label[p].pj_id;var m=e.pj_label[p].pj_link;r[p]="http"===m.slice(0,4)?m:"http://"+m,l[p]=[],l[p][0]=[],l[p][1]=[],s[p]=[],o[p].build_id=[]}e.data.forEach(function(a){var r=i.indexOf(a.pj_id);o[r].build_id.push(a.build_id),a.start_t||(a.start_t="0"),t[r].length<e.maxLabel&&("0"===a.start_t?t[r].push("Failed"):t[r].push(a.start_t.slice(5,10))),n[r][0].push(a.pass),n[r][1].push(a.fail),n[r][2].push(a.skip),l[r][0]?l[r][0]<1*a.buildno&&(l[r][0]=a.buildno,l[r][1]="0"===a.start_t?"Build Failed":a.start_t,s[r]=a.duration.slice(0,2)+"h "+a.duration.slice(3,5)+"m "+a.duration.slice(6,8)+"s"):(l[r][0]=-1,l[r][1]="1453/05/29 09:00:00")});for(var g="rgba(102, 194, 255,",h="rgba(255, 115, 115,",f="rgba(130, 130, 130,",v=0;v<c;v++)a[v]={labels:t[v],datasets:[{label:"Fail",backgroundColor:h+" 0.7)",borderColor:h+" 0.7)",pointBorderColor:h+" 0.7)",pointBackgroundColor:h+" 0.7)",pointHoverBackgroundColor:"#fff",pointHoverBorderColor:h+" 1)",data:n[v][1]},{label:"Skip",backgroundColor:f+" 0.7)",borderColor:f+" 0.7)",pointBorderColor:f+" 0.7)",pointBackgroundColor:f+" 0.7)",pointHoverBackgroundColor:"#fff",pointHoverBorderColor:f+" 1)",data:n[v][2]},{label:"Pass",backgroundColor:g+" 0.7)",borderColor:g+" 0.7)",pointBorderColor:g+" 0.7)",pointBackgroundColor:g+" 0.7)",pointHoverBackgroundColor:"#fff",pointHoverBorderColor:g+" 1)",data:n[v][0]}]};return{getInnerData:function(){return a},getPjLabel:function(){return o},getBuildTime:function(){return l},getDuration:function(){return s},getPjLink:function(){return r},getTotalChartCount:function(){return c},getInitialModalData:function(){return d}}}function processModalData(e){var t=[],n=[],a=[],i=[],o=[],r=[],l=[],s=[],d=0,c=0,u=0,p=0,m=[],g=e.classcount;return e.data.forEach(function(e){var t=e.pass+e.fail+e.skip;n.push(e.pass),a.push(e.fail),i.push(e.skip),r.push(Math.round(e.pass/t*100).toFixed(1)),l.push(Math.round(e.fail/t*100).toFixed(1)),s.push(Math.round(e.skip/t*100).toFixed(1)),o.push(t),d+=e.pass,c+=e.fail,u+=e.skip,m.push([e.package_name,e.class_name])}),p=d+c+u,t={labels:["Fail","Skip","Pass"],datasets:[{data:[Math.round(c/p*100).toFixed(1),Math.round(u/p*100).toFixed(1),Math.round(d/p*100).toFixed(1)],backgroundColor:["rgba(255, 115, 115, 0.7)","rgba(130, 130, 130, 0.7)","rgba(102, 194, 255, 0.7)"],hoverBackgroundColor:["rgba(255, 115, 115, 1.0)","rgba(130, 130, 130, 1.0)","rgba(102, 194, 255, 1.0)"],label:["Fail","Skip","Pass"]}]},{getpieChartData:function(){return t},getClassCount:function(){return g},getProgressData:function(){return{pass:n,fail:a,skip:i,sum:o,passrate:r,failrate:l,skiprate:s}},getNameData:function(){return m},getBuildTime:function(){return e.data[0].start_t}}}function init_knob(){if(void 0!==$.fn.knob&&document.getElementById("knobInput")){console.log("init_knob");var e=new XMLHttpRequest,t=document;t.getElementById("labelSubmit").addEventListener("click",function(){t.getElementById("newMaxLabel").value=t.getElementById("newMaxLabel_text").innerText}),e.open("GET",selectDataApi("knob",null),!0),e.send(),e.addEventListener("load",function(){var n=JSON.parse(e.responseText);t.getElementById("knobInput").value=n,t.getElementById("MaxLabel_text").innerText="현재 : "+n+"개",$(".knob").knob({min:1,max:20,thickness:.2,displayPrevious:!0,inputColor:"#34495E",fgColor:"#34495E",change:function(e){},release:function(e){t.getElementById("newMaxLabel_text").innerText="변경 : "+e+"개"},cancel:function(){console.log("cancel : ",this)},draw:function(){this.cursorExt=.3;var e,t=this.arc(this.cv);return this.g.lineWidth=this.lineWidth,this.o.displayPrevious&&(e=this.arc(this.v),this.g.beginPath(),this.g.strokeStyle=this.pColor,this.g.arc(this.xy,this.xy,this.radius-this.lineWidth,e.s,e.e,e.d),this.g.stroke()),this.g.beginPath(),this.g.strokeStyle=this.o.fgColor,this.g.arc(this.xy,this.xy,this.radius-this.lineWidth,t.s,t.e,t.d),this.g.stroke(),this.g.lineWidth=2,this.g.beginPath(),this.g.strokeStyle=this.o.fgColor,this.g.arc(this.xy,this.xy,this.radius-this.lineWidth+1+2*this.lineWidth/3,0,2*Math.PI,!1),this.g.stroke(),!1}})})}}function init_SmartWizard(){void 0!==$.fn.smartWizard&&(console.log("init_SmartWizard"),$("#wizard").smartWizard(),$("#wizard_verticle").smartWizard({transitionEffect:"slide"}),$(".buttonNext").addClass("btn btn-success"),$(".buttonPrevious").addClass("btn btn-primary"))}function init_select2(){if(document.getElementById("select2Div0")){console.log("init_select2");for(var e=[[],[],[],[]],t=[],n=document,a=document.createDocumentFragment(),i=0;i<4;i++)$("#select2_multiple"+i).select2({maximumSelectionLength:2,placeholder:"이전 항목을 선택해주세요",containerCssClass:":all:",allowClear:!0,dropdownParent:$("#select2Div"+i)});var o=n.createElement("option");o.innerText="Project 명",o.setAttribute("display","none"),a.appendChild(o);var r=new XMLHttpRequest;r.onreadystatechange=function(){404===r.status?window.location="/404":500===r.status&&(window.location="/500")},r.open("GET",selectDataApi("custom",{unit:"project",preValId:-1}),!0),r.send(),r.addEventListener("load",function(){e[0]=JSON.parse(r.responseText),e[0].forEach(function(e){var t=n.createElement("option");t.innerText=e.pj_name,a.appendChild(t)}),document.getElementById("select2_multiple0").appendChild(a)});for(var l=0;l<4;l++)$("#select2_multiple"+l).on("change",function(a){return function(){var i=$("#select2_multiple"+a).val(),o=$("#select2_multiple"+a)[0].selectedIndex;if($.isEmptyObject(i)||"Project 명"===i){for(var r=3;r>a;r--)$("#select2_multiple"+r).attr("disabled",!0);t.splice(a)}else{var l;l=0===a?e[0][o-1].pj_id:1===a?e[1][o].build_id:2===a?e[2][o].class_id:e[3][o].method_id,t[a]=l;var s=["buildno","class","testcase"];if(a>=0&&a<=2){var d=new XMLHttpRequest;d.open("GET",selectDataApi("custom",{unit:s[a],preValId:l}),!0),d.send(),d.addEventListener("load",function(){var t=document.createDocumentFragment();e[a+1]=[],$("#select2_multiple"+(a+1)).empty(),e[a+1]=JSON.parse(d.responseText),e[a+1].forEach(function(e){var a=n.createElement("option");e.buildno?a.innerText="(Build No."+e.buildno+") ":e.class_name?a.innerText=e.package_name+" / "+e.class_name:e.method_name&&(a.innerText=e.method_name),t.append(a)}),$("#select2_multiple"+(a+1)).append(t)}),$("#select2_multiple"+(a+1)).removeAttr("disabled")}}}}(l));document.getElementById("customSubmitBtn").addEventListener("click",function(){if("Project 명"!==$("#select2_multiple0").val()){var e=document.createDocumentFragment(),a=new XMLHttpRequest;a.open("POST","/access/deleteData",!0),a.setRequestHeader("Content-type","application/json"),a.onreadystatechange=function(){404===a.status?window.location="/404":500===a.status&&(window.location="/500")},a.send(JSON.stringify({selectId:t})),a.addEventListener("load",function(){var t=n.createElement("div"),i=n.createElement("div"),o=n.createElement("h2"),r=n.createElement("div"),l=n.createElement("div"),s=n.createElement("div");t.setAttribute("class","x_panel"),i.setAttribute("class","x_title"),o.innerText="결과",o.setAttribute("text-align","center"),r.setAttribute("class","clearfix"),l.setAttribute("class","x_content"),s.setAttribute("id","resultDiv"),t.appendChild(i),i.appendChild(o),i.appendChild(r),t.appendChild(l),l.appendChild(s),s.innerHTML=a.responseText,e.appendChild(t),document.getElementById("customSortDiv").appendChild(e)})}})}}function clear_modalDetail(){var e=document.getElementById("noChart"),t=document.getElementById("noInfo"),n=document.getElementById("pieChart_timeInfo"),a=document.getElementById("pieChart_passInfo");document.getElementById("panel_report").removeChild(document.getElementById("pieChart_mo"));var i=document.createElement("canvas");i.setAttribute("id","pieChart_mo"),document.getElementById("panel_report").appendChild(i),document.getElementById("panel_detailReport").removeChild(document.getElementById("classinfo"));var o=document.createElement("div");o.setAttribute("id","classinfo"),document.getElementById("panel_detailReport").appendChild(o),e.innerText="",t.innerText="",n.innerText="",a.innerText=""}function init_modal_detail(e,t){var n=new XMLHttpRequest;n.onreadystatechange=function(){404===n.status?window.location="/404":500===n.status&&(window.location="/500")},n.open("GET",selectDataApi("modalDetail",{pj_id:e,build_id:t}),!0),n.send(),n.addEventListener("load",function(){var e=processModalData(JSON.parse(n.responseText)),t=document.getElementById("noChart"),a=document.getElementById("noInfo"),i=document.getElementById("pieChart_timeInfo"),o=document.getElementById("pieChart_passInfo");if(clear_modalDetail(),0===e.getClassCount())t.innerText="실패한 Build입니다",a.innerText="실패한 Build입니다";else{for(var r,l=document.createDocumentFragment(),s="",d=-1,c=0;c<e.getClassCount();c++){if(e.getNameData()[c][0]!==s){s=e.getNameData()[c][0],d++,(r=document.createElement("tbody")).setAttribute("id","tbody"+d);var u=document.createElement("table");setAttributes(u,{id:"detailTable"+d,class:"table table-hover",style:"text-align:center;"});var p=document.createElement("thead"),m=document.createElement("tr"),g=document.createElement("th");g.innerText=e.getNameData()[c][0],m.appendChild(g),p.appendChild(m),u.appendChild(p),u.appendChild(r),l.appendChild(u)}var h=document.createElement("tr"),f=document.createElement("th"),v=document.createElement("th");f.setAttribute("class","col-lg-5 col-md-5 col-sm-5 col-xs-12"),f.innerText=e.getNameData()[c][1],h.appendChild(f),v.setAttribute("class","col-lg-7 col-md-7 col-sm-7 col-xs-12");var _=document.createElement("div");_.setAttribute("class","progress");var E=document.createElement("div"),b=document.createElement("div"),C=document.createElement("div");setAttributes(E,{id:"propass"+c,class:"progress-bar progress-bar-striped progress-pass",role:"progressbar","aria-valuenow":e.getProgressData().pass[c],"aria-valuemin":0,"aria-valuemax":e.getProgressData().sum[c],style:"width: "+e.getProgressData().passrate[c]+"%"}),E.innerText=e.getProgressData().pass[c],setAttributes(b,{id:"profail"+c,class:"progress-bar progress-bar-striped progress-fail",role:"progressbar","aria-valuenow":e.getProgressData().fail[c],"aria-valuemin":0,"aria-valuemax":e.getProgressData().sum[c],style:"width: "+e.getProgressData().failrate[c]+"%"}),b.innerText=e.getProgressData().fail[c],setAttributes(C,{id:"proskip"+c,class:"progress-bar progress-bar-striped progress-skip",role:"progressbar","aria-valuenow":e.getProgressData().skip[c],"aria-valuemin":0,"aria-valuemax":e.getProgressData().sum[c],style:"width: "+e.getProgressData().skiprate[c]+"%"}),C.innerText=e.getProgressData().skip[c],_.appendChild(E),_.appendChild(b),_.appendChild(C),v.appendChild(_),h.appendChild(v),r.appendChild(h)}document.getElementById("classinfo").appendChild(l),i.innerText="빌드 시작시간 : "+e.getBuildTime(),o.innerText="성공률 : "+e.getpieChartData().datasets[0].data[2]+"%";new Chart(document.getElementById("pieChart_mo"),{type:"pie",data:e.getpieChartData(),options:{legend:!1}})}})}function init_modal(e,t){return function(){if(document.getElementById("detailPage")){var n=new XMLHttpRequest;n.onreadystatechange=function(){404===n.status?window.location="/404":500===n.status&&(window.location="/500")},n.open("GET",selectDataApi("initialModal",{pj_id:e}),!0),n.send(),n.addEventListener("load",function(){var e=processdata(JSON.parse(n.responseText)),t=new Chart(document.getElementById("lineChart_mo"),{type:"line",data:e.getInnerData()[0],options:chartOption}),a=-1;document.getElementById("detailPageLabel").innerText="More Info - "+e.getPjLabel()[0].pj_name,document.getElementById("platform_mo").innerText="환경 : "+e.getInitialModalData()[0],document.getElementById("team_mo").innerText="팀 : "+e.getInitialModalData()[1],document.getElementById("author_mo").innerText="사용자 : "+e.getInitialModalData()[2],document.getElementById("lineChart_mo").addEventListener("click",function(n){var i=t.getElementsAtEventForMode(n,"index",{intersect:!1});if(0!=i.length){var o=e.getPjLabel()[0].build_id[i[0]._index];a!=o&&(a=o,init_modal_detail(e.getPjLabel()[0].pj_id,o))}})}),init_modal_detail(e,t)}}}function init_charts(){if(document.getElementById("chartDiv")&&"undefined"!=typeof Chart){console.log("init_charts"),Chart.defaults.global.legend=!1;var e=document;$("#detailPage").on("hidden.bs.modal",function(){var t=e.createElement("canvas");setAttributes(t,{id:"lineChart_mo",height:"50%"}),e.getElementById("panel_mo").removeChild(e.getElementById("lineChart_mo")),e.getElementById("panel_mo").appendChild(t),e.getElementById("detailPageLabel").innerText="More Info - ",e.getElementById("platform_mo").innerText="환경 : ",e.getElementById("team_mo").innerText="팀 : ",e.getElementById("author_mo").innerText="사용자 : ",clear_modalDetail()});var t=new XMLHttpRequest;t.onreadystatechange=function(){404===t.status?window.location="/404":500===t.status&&(window.location="/500")},t.open("GET",selectDataApi("chart",null),!0),t.send(),t.addEventListener("load",function(){for(var n=processdata(JSON.parse(t.responseText)),a=n.getTotalChartCount(),i=0;i<a;i++){e.getElementById("title"+i).innerText=n.getPjLabel()[i].pj_name,e.getElementById("build"+i).innerText="Last Build : "+n.getBuildTime()[i][1],e.getElementById("duration"+i).innerText="Duration : "+n.getDuration()[i],"http://-"!==n.getPjLink()[i]&&(e.getElementById("link"+i).setAttribute("href",n.getPjLink()[i]),e.getElementById("link"+i).innerText="Report Link");var o=document.getElementById("lineChart"+i);!function(e,t){document.getElementById("lineChart"+t).addEventListener("click",function(a){var i=e.getElementsAtEventForMode(a,"index",{intersect:!1}),o=n.getPjLabel()[t];0!=i.length&&($("#detailPage").modal("show"),init_modal(o.pj_id,o.build_id[i[0]._index])())})}(new Chart(o,{type:"line",data:n.getInnerData()[i],options:chartOption}),i)}})}}function init_compose(){void 0!==$.fn.slideToggle&&(console.log("init_compose"),$("#compose, .compose-close").click(function(){$(".compose").slideToggle()}))}!function(e,t){var n=function(e,t,n){var a;return function(){var i=this,o=arguments;a?clearTimeout(a):n&&e.apply(i,o),a=setTimeout(function(){n||e.apply(i,o),a=null},t||100)}};jQuery.fn[t]=function(e){return e?this.bind("resize",n(e)):this.trigger(t)}}(jQuery,"smartresize"),"undefined"!=typeof NProgress&&NProgress.start();var CURRENT_URL=window.location.href.split("#")[0].split("?")[0],$BODY=$("body"),$MENU_TOGGLE=$("#menu_toggle"),$SIDEBAR_MENU=$("#sidebar-menu"),$SIDEBAR_FOOTER=$(".sidebar-footer"),$LEFT_COL=$(".left_col"),$RIGHT_COL=$(".right_col"),$NAV_MENU=$(".nav_menu"),$FOOTER=$("footer");$(document).ready(function(){init_sidebar(),init_panel(),init_tooltip()});var chartOption={hover:{intersect:!1},tooltips:{mode:"index",intersect:!1,itemSort:function(e,t){return t.datasetIndex-e.datasetIndex}},scales:{yAxes:[{stacked:!0}]},elements:{line:{tension:0,borderWidth:1},point:{radius:0,borderWidth:2,hitRadius:20}}};$(document).ready(function(){init_knob(),init_SmartWizard(),init_charts(),init_select2(),init_compose()}),$(window).on("load",function(){NProgress.done()});