function setAttributes(e,t){for(var n in t)e.setAttribute(n,t[n])}!function(e,t){jQuery.fn[t]=function(e){return e?this.bind("resize",(n=e,function(){var e=this,t=arguments;o?clearTimeout(o):i&&n.apply(e,t),o=setTimeout(function(){i||n.apply(e,t),o=null},a||100)})):this.trigger(t);var n,a,i,o}}(jQuery,"smartresize"),"undefined"!=typeof NProgress&&NProgress.start();var CURRENT_URL=window.location.href.split("#")[0].split("?")[0],$BODY=$("body"),$MENU_TOGGLE=$("#menu_toggle"),$SIDEBAR_MENU=$("#sidebar-menu"),$SIDEBAR_FOOTER=$(".sidebar-footer"),$LEFT_COL=$(".left_col"),$RIGHT_COL=$(".right_col"),$NAV_MENU=$(".nav_menu"),$FOOTER=$("footer");function init_sidebar(){var n=function(){$RIGHT_COL.css("min-height",$(window).height());var e=$BODY.outerHeight(),t=$BODY.hasClass("footer_fixed")?-10:$FOOTER.height(),n=$LEFT_COL.eq(1).height()+$SIDEBAR_FOOTER.height(),a=e<n?n:e;a-=$NAV_MENU.height()+t,$RIGHT_COL.css("min-height",a)};$SIDEBAR_MENU.find("a").on("click",function(e){var t=$(this).parent();t.is(".active")?(t.removeClass("active active-sm"),$("ul:first",t).slideUp(function(){n()})):(t.parent().is(".child_menu")?$BODY.is(".nav-sm")&&($SIDEBAR_MENU.find("li").removeClass("active active-sm"),$SIDEBAR_MENU.find("li ul").slideUp()):($SIDEBAR_MENU.find("li").removeClass("active active-sm"),$SIDEBAR_MENU.find("li ul").slideUp()),t.addClass("active"),$("ul:first",t).slideDown(function(){n()}))}),$MENU_TOGGLE.on("click",function(){$BODY.hasClass("nav-md")?($SIDEBAR_MENU.find("li.active ul").hide(),$SIDEBAR_MENU.find("li.active").addClass("active-sm").removeClass("active")):($SIDEBAR_MENU.find("li.active-sm ul").show(),$SIDEBAR_MENU.find("li.active-sm").addClass("active").removeClass("active-sm")),$BODY.toggleClass("nav-md nav-sm"),n(),$(".dataTable").each(function(){$(this).dataTable().fnDraw()})}),$SIDEBAR_MENU.find("a[href='"+CURRENT_URL+"']").parent("li").addClass("current-page"),$SIDEBAR_MENU.find("a").filter(function(){return this.href==CURRENT_URL}).parent("li").addClass("current-page").parents("ul").slideDown(function(){n()}).parent().addClass("active"),$(window).smartresize(function(){n()}),n(),$.fn.mCustomScrollbar&&$(".menu_fixed").mCustomScrollbar({autoHideScrollbar:!0,theme:"minimal",mouseWheel:{preventDefault:!0}})}function init_panel(){$(".collapse-link").on("click",function(){var e=$(this).closest(".x_panel"),t=$(this).find("i"),n=e.find(".x_content");e.attr("style")?n.slideToggle(200,function(){e.removeAttr("style")}):(n.slideToggle(200),e.css("height","auto")),t.toggleClass("fa-chevron-up fa-chevron-down")}),$(".close-link").click(function(){$(this).closest(".x_panel").remove()})}function init_tooltip(){$("[data-toggle='tooltip']").tooltip({container:"body"})}$(document).ready(function(){init_sidebar(),init_panel(),init_tooltip()});var chartOption={hover:{intersect:!1},tooltips:{mode:"index",intersect:!1,itemSort:function(e,t){return t.datasetIndex-e.datasetIndex},callbacks:{title:function(e,t){return t.tooltip[e[0].index]}}},scales:{yAxes:[{stacked:!0}]},elements:{line:{tension:0,borderWidth:1},point:{radius:0,borderWidth:2,hitRadius:20}}};function processdata(n){var a=[],i=[],e=[],o=[],r=[],s=[],t=[],l=[],d=[],c=[],u=n.totalChartCount;if(s=n.pj_label.slice(),u){var p=n.pj_label[0].pj_platform;p="pcWeb"===p?"PC Web":"mobileWeb"===p?"Mobile Web":"mobileApp"===p?"Mobile App":"Error",c.push(p),c.push(n.pj_label[0].pj_team),c.push(n.pj_label[0].pj_author)}for(var m=0;m<u;m++){a[m]=[],r[m]=[],i[m]=[],i[m][0]=[],i[m][1]=[],i[m][2]=[],o[m]=n.pj_label[m].pj_id;var g=n.pj_label[m].pj_link;t[m]="http"===g.slice(0,4)?g:"http://"+g,l[m]=[],l[m][0]=[],l[m][1]=[],d[m]=[],s[m].build_id=[]}n.data.forEach(function(e){var t=o.indexOf(e.pj_id);s[t].build_id.push(e.build_id),e.start_t||(e.start_t="0"),a[t].length<n.maxLabel&&("0"===e.start_t?a[t].push("Failed"):a[t].push(e.start_t.slice(5,10)),r[t].push(e.buildenv)),i[t][0].push(e.pass),i[t][1].push(e.fail),i[t][2].push(e.skip),l[t][0]?l[t][0]<1*e.buildno&&(l[t][0]=e.buildno,l[t][1]="0"===e.start_t?"Build Failed":e.start_t,d[t]=e.duration.slice(0,2)+"h "+e.duration.slice(3,5)+"m "+e.duration.slice(6,8)+"s"):(l[t][0]=-1,l[t][1]="1453/05/29 09:00:00")});for(var h="rgba(102, 194, 255,",f="rgba(255, 115, 115,",v="rgba(130, 130, 130,",_=0;_<u;_++)e[_]={labels:a[_],datasets:[{label:"Fail",backgroundColor:f+" 0.7)",borderColor:f+" 0.7)",pointBorderColor:f+" 0.7)",pointBackgroundColor:f+" 0.7)",pointHoverBackgroundColor:"#fff",pointHoverBorderColor:f+" 1)",data:i[_][1]},{label:"Skip",backgroundColor:v+" 0.7)",borderColor:v+" 0.7)",pointBorderColor:v+" 0.7)",pointBackgroundColor:v+" 0.7)",pointHoverBackgroundColor:"#fff",pointHoverBorderColor:v+" 1)",data:i[_][2]},{label:"Pass",backgroundColor:h+" 0.7)",borderColor:h+" 0.7)",pointBorderColor:h+" 0.7)",pointBackgroundColor:h+" 0.7)",pointHoverBackgroundColor:"#fff",pointHoverBorderColor:h+" 1)",data:i[_][0]}],tooltip:r[_]};return{getInnerData:function(){return e},getPjLabel:function(){return s},getBuildTime:function(){return l},getDuration:function(){return d},getPjLink:function(){return t},getTotalChartCount:function(){return u},getInitialModalData:function(){return c}}}function processModalData(e){var t,n,a=[],i=[],o=[],r=[],s=[],l=[],d=[],c=0,u=0,p=0,m=[],g=e.classcount;return e.data.forEach(function(e){var t=e.pass+e.fail+e.skip;a.push(e.pass),i.push(e.fail),o.push(e.skip),s.push(Math.round(e.pass/t*100).toFixed(1)),l.push(Math.round(e.fail/t*100).toFixed(1)),d.push(Math.round(e.skip/t*100).toFixed(1)),r.push(t),c+=e.pass,u+=e.fail,p+=e.skip,m.push([e.package_name,e.class_name])}),n=c+u+p,t={labels:["Fail","Skip","Pass"],datasets:[{data:[Math.round(u/n*100).toFixed(1),Math.round(p/n*100).toFixed(1),Math.round(c/n*100).toFixed(1)],backgroundColor:["rgba(255, 115, 115, 0.7)","rgba(130, 130, 130, 0.7)","rgba(102, 194, 255, 0.7)"],hoverBackgroundColor:["rgba(255, 115, 115, 1.0)","rgba(130, 130, 130, 1.0)","rgba(102, 194, 255, 1.0)"],label:["Fail","Skip","Pass"]}]},{getpieChartData:function(){return t},getClassCount:function(){return g},getProgressData:function(){return{pass:a,fail:i,skip:o,sum:r,passrate:s,failrate:l,skiprate:d}},getNameData:function(){return m},getBuildTime:function(){return e.data[0].start_t}}}function init_knob(){if(void 0!==$.fn.knob&&document.getElementById("knobInput")){console.log("init_knob");var t=new XMLHttpRequest,n=document;n.getElementById("labelSubmit").addEventListener("click",function(){n.getElementById("newMaxLabel").value=n.getElementById("newMaxLabel_text").innerText}),t.open("GET","/admin/getKnobData",!0),t.send(),t.addEventListener("load",function(){var e=JSON.parse(t.responseText);n.getElementById("knobInput").value=e,n.getElementById("MaxLabel_text").innerText="현재 : "+e+"개",$(".knob").knob({min:1,max:20,thickness:.2,displayPrevious:!0,inputColor:"#34495E",fgColor:"#34495E",change:function(e){},release:function(e){n.getElementById("newMaxLabel_text").innerText="변경 : "+e+"개"},cancel:function(){console.log("cancel : ",this)},draw:function(){this.cursorExt=.3;var e,t=this.arc(this.cv);return this.g.lineWidth=this.lineWidth,this.o.displayPrevious&&(e=this.arc(this.v),this.g.beginPath(),this.g.strokeStyle=this.pColor,this.g.arc(this.xy,this.xy,this.radius-this.lineWidth,e.s,e.e,e.d),this.g.stroke()),this.g.beginPath(),this.g.strokeStyle=this.o.fgColor,this.g.arc(this.xy,this.xy,this.radius-this.lineWidth,t.s,t.e,t.d),this.g.stroke(),this.g.lineWidth=2,this.g.beginPath(),this.g.strokeStyle=this.o.fgColor,this.g.arc(this.xy,this.xy,this.radius-this.lineWidth+1+2*this.lineWidth/3,0,2*Math.PI,!1),this.g.stroke(),!1}})})}}function init_SmartWizard(){void 0!==$.fn.smartWizard&&(console.log("init_SmartWizard"),$("#wizard").smartWizard(),$("#wizard_verticle").smartWizard({transitionEffect:"slide"}),$(".buttonNext").addClass("btn btn-success"),$(".buttonPrevious").addClass("btn btn-primary"))}function init_select2(){if(document.getElementById("select2Div0")){console.log("init_select2");for(var r=[[],[],[],[]],s=[],l=document,n=document.createDocumentFragment(),e=0;e<4;e++)$("#select2_multiple"+e).select2({maximumSelectionLength:2,placeholder:"이전 항목을 선택해주세요",containerCssClass:":all:",allowClear:!0,dropdownParent:$("#select2Div"+e)});var t=l.createElement("option");t.innerText="Project 명",t.setAttribute("display","none"),n.appendChild(t);var a=new XMLHttpRequest;a.onreadystatechange=function(){404===a.status?window.location="/404":500===a.status&&(window.location="/500")},a.open("GET","/getData/getCustomData?un=pj&vi=-1",!0),a.send(),a.addEventListener("load",function(){r[0]=JSON.parse(a.responseText),r[0].forEach(function(e){var t=l.createElement("option");t.innerText=e.pj_name,n.appendChild(t)}),document.getElementById("select2_multiple0").appendChild(n)});for(var i=0;i<4;i++)$("#select2_multiple"+i).on("change",o(i));document.getElementById("customSubmitBtn").addEventListener("click",function(){if("Project 명"!==$("#select2_multiple0").val()){var e=new XMLHttpRequest;e.open("POST","/access/deleteData",!0),e.setRequestHeader("Content-type","application/json"),e.onreadystatechange=function(){404===e.status?window.location="/404":500===e.status&&(window.location="/500")},e.send(JSON.stringify({selectId:s})),e.addEventListener("load",function(){alert("결과 : "+e.responseText)})}})}function o(o){return function(){var e=$("#select2_multiple"+o).val(),t=$("#select2_multiple"+o)[0].selectedIndex;if($.isEmptyObject(e)||"Project 명"===e){for(var n=3;o<n;n--)$("#select2_multiple"+n).attr("disabled",!0);s.splice(o)}else{var a;if(a=0===o?r[0][t-1].pj_id:1===o?r[1][t].build_id:2===o?r[2][t].class_id:r[3][t].method_id,s[o]=a,0<=o&&o<=2){var i=new XMLHttpRequest;i.open("GET","/getData/getCustomData?un="+["bu","cl","te"][o]+"&vi="+a,!0),i.send(),i.addEventListener("load",function(){var n=document.createDocumentFragment();r[o+1]=[],$("#select2_multiple"+(o+1)).empty(),r[o+1]=JSON.parse(i.responseText),r[o+1].forEach(function(e){var t=l.createElement("option");e.buildno?t.innerText="(Build No."+e.buildno+") ":e.class_name?t.innerText=e.package_name+" / "+e.class_name:e.method_name&&(t.innerText=e.method_name),n.append(t)}),$("#select2_multiple"+(o+1)).append(n)}),$("#select2_multiple"+(o+1)).removeAttr("disabled")}}}}}function clear_modalDetail(){var e=document.getElementById("noChart"),t=document.getElementById("noInfo"),n=document.getElementById("pieChart_timeInfo"),a=document.getElementById("pieChart_passInfo");document.getElementById("panel_report").removeChild(document.getElementById("pieChart_mo"));var i=document.createElement("canvas");i.setAttribute("id","pieChart_mo"),document.getElementById("panel_report").appendChild(i),document.getElementById("panel_detailReport").removeChild(document.getElementById("classinfo"));var o=document.createElement("div");o.setAttribute("id","classinfo"),document.getElementById("panel_detailReport").appendChild(o),e.innerText="",t.innerText="",n.innerText="",a.innerText=""}function init_modal_detail(e,t){var C=new XMLHttpRequest;C.onreadystatechange=function(){404===C.status?window.location="/404":500===C.status&&(window.location="/500")},C.open("GET","/getData/getModalDataDetail?pi="+e+"&bi="+t,!0),C.send(),C.addEventListener("load",function(){var e=processModalData(JSON.parse(C.responseText)),t=document.getElementById("noChart"),n=document.getElementById("noInfo"),a=document.getElementById("pieChart_timeInfo"),i=document.getElementById("pieChart_passInfo");if(clear_modalDetail(),0===e.getClassCount())t.innerText="실패한 Build입니다",n.innerText="실패한 Build입니다";else{for(var o,r=document.createDocumentFragment(),s="",l=-1,d=0;d<e.getClassCount();d++){if(e.getNameData()[d][0]!==s){s=e.getNameData()[d][0],l++,(o=document.createElement("tbody")).setAttribute("id","tbody"+l);var c=document.createElement("table");setAttributes(c,{id:"detailTable"+l,class:"table table-hover",style:"text-align:center;"});var u=document.createElement("thead"),p=document.createElement("tr"),m=document.createElement("th");m.innerText=e.getNameData()[d][0],p.appendChild(m),u.appendChild(p),c.appendChild(u),c.appendChild(o),r.appendChild(c)}var g=document.createElement("tr"),h=document.createElement("th"),f=document.createElement("th");h.setAttribute("class","col-lg-5 col-md-5 col-sm-5 col-xs-12"),h.innerText=e.getNameData()[d][1],g.appendChild(h),f.setAttribute("class","col-lg-7 col-md-7 col-sm-7 col-xs-12");var v=document.createElement("div");v.setAttribute("class","progress");var _=document.createElement("div"),E=document.createElement("div"),b=document.createElement("div");setAttributes(_,{id:"propass"+d,class:"progress-bar progress-bar-striped progress-pass",role:"progressbar","aria-valuenow":e.getProgressData().pass[d],"aria-valuemin":0,"aria-valuemax":e.getProgressData().sum[d],style:"width: "+e.getProgressData().passrate[d]+"%"}),_.innerText=e.getProgressData().pass[d],setAttributes(E,{id:"profail"+d,class:"progress-bar progress-bar-striped progress-fail",role:"progressbar","aria-valuenow":e.getProgressData().fail[d],"aria-valuemin":0,"aria-valuemax":e.getProgressData().sum[d],style:"width: "+e.getProgressData().failrate[d]+"%"}),E.innerText=e.getProgressData().fail[d],setAttributes(b,{id:"proskip"+d,class:"progress-bar progress-bar-striped progress-skip",role:"progressbar","aria-valuenow":e.getProgressData().skip[d],"aria-valuemin":0,"aria-valuemax":e.getProgressData().sum[d],style:"width: "+e.getProgressData().skiprate[d]+"%"}),b.innerText=e.getProgressData().skip[d],v.appendChild(_),v.appendChild(E),v.appendChild(b),f.appendChild(v),g.appendChild(f),o.appendChild(g)}document.getElementById("classinfo").appendChild(r),a.innerText="빌드 시작시간 : "+e.getBuildTime(),i.innerText="성공률 : "+e.getpieChartData().datasets[0].data[2]+"%";new Chart(document.getElementById("pieChart_mo"),{type:"pie",data:e.getpieChartData(),options:{legend:!1}})}})}function init_modal(t,n){return function(){if(document.getElementById("detailPage")){var e=new XMLHttpRequest;e.onreadystatechange=function(){404===e.status?window.location="/404":500===e.status&&(window.location="/500")},e.open("GET","/getData/getInitialModalData?pi="+t,!0),e.send(),e.addEventListener("load",function(){var a=processdata(JSON.parse(e.responseText)),i=new Chart(document.getElementById("lineChart_mo"),{type:"line",data:a.getInnerData()[0],options:chartOption}),o=-1;document.getElementById("detailPageLabel").innerText="More Info - "+a.getPjLabel()[0].pj_name,document.getElementById("platform_mo").innerText="환경 : "+a.getInitialModalData()[0],document.getElementById("team_mo").innerText="팀 : "+a.getInitialModalData()[1],document.getElementById("author_mo").innerText="사용자 : "+a.getInitialModalData()[2],document.getElementById("lineChart_mo").addEventListener("click",function(e){var t=i.getElementsAtEventForMode(e,"index",{intersect:!1});if(0!=t.length){var n=a.getPjLabel()[0].build_id[t[0]._index];o!=n&&(o=n,init_modal_detail(a.getPjLabel()[0].pj_id,n))}})}),init_modal_detail(t,n)}}}function urlByBrowser(){var e=navigator.userAgent.toLowerCase();return-1<e.indexOf("msie")||e.indexOf(!1)?document.URL:document.documentURI}function init_charts(){if(document.getElementById("chartDiv")&&"undefined"!=typeof Chart){console.log("init_charts"),Chart.defaults.global.legend=!1,$("#detailPage").on("hidden.bs.modal",function(){var e=i.createElement("canvas");setAttributes(e,{id:"lineChart_mo",height:"50%"}),i.getElementById("panel_mo").removeChild(i.getElementById("lineChart_mo")),i.getElementById("panel_mo").appendChild(e),i.getElementById("detailPageLabel").innerText="More Info - ",i.getElementById("platform_mo").innerText="환경 : ",i.getElementById("team_mo").innerText="팀 : ",i.getElementById("author_mo").innerText="사용자 : ",clear_modalDetail()});var i=document,e=urlByBrowser();e=e.substring(e.indexOf(":")+3);var r=new XMLHttpRequest;r.onreadystatechange=function(){404===r.status?window.location="/404":500===r.status&&(window.location="/500")},r.open("GET","/getData/getChartData"+e.substring(e.indexOf("/")),!0),r.send(),r.addEventListener("load",function(){var o=processdata(JSON.parse(r.responseText)),e=o.getTotalChartCount();function t(a,i){document.getElementById("lineChart"+i).addEventListener("click",function(e){var t=a.getElementsAtEventForMode(e,"index",{intersect:!1}),n=o.getPjLabel()[i];0!=t.length&&($("#detailPage").modal("show"),init_modal(n.pj_id,n.build_id[t[0]._index])())})}for(var n=0;n<e;n++){i.getElementById("title"+n).innerText=o.getPjLabel()[n].pj_name,i.getElementById("build"+n).innerText="Last Build : "+o.getBuildTime()[n][1],i.getElementById("duration"+n).innerText="Duration : "+o.getDuration()[n],"http://-"!==o.getPjLink()[n]&&(i.getElementById("link"+n).setAttribute("href",o.getPjLink()[n]),i.getElementById("link"+n).innerText="Report Link");var a=document.getElementById("lineChart"+n);t(new Chart(a,{type:"line",data:o.getInnerData()[n],options:chartOption}),n)}})}}function init_compose(){void 0!==$.fn.slideToggle&&(console.log("init_compose"),$("#compose, .compose-close").click(function(){$(".compose").slideToggle()}))}$(document).ready(function(){init_knob(),init_SmartWizard(),init_charts(),init_select2(),init_compose()}),$(window).on("load",function(){NProgress.done()});